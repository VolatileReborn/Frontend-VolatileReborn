{"ast":null,"code":"import { FolderChecked } from \"@element-plus/icons-vue\";\nimport { ElMessage } from \"element-plus\";\nimport { Edit } from \"@element-plus/icons-vue\";\nimport { StarFilled } from \"@element-plus/icons-vue\";\nimport { employerBrowserTaskDetail } from \"@/api/task\";\nimport { browserReports } from \"@/api/report\";\nimport oss from \"@/utils/oss\";\n\nconst goReport = val => {\n  console.log(val);\n  this.$router.push({\n    path: \"/reportInfo\",\n    params: {\n      taskId: this.taskId,\n      reportId: val.reportId\n    }\n  });\n};\n\nexport default {\n  name: \"TaskInfoFromUser\",\n\n  data() {\n    return {\n      taskId: this.$route.params.taskId,\n      task: {\n        taskId: this.taskId,\n        taskName: '',\n        taskType: 0,\n        workerNumTotal: 0,\n        workerNumLeft: 0,\n        taskStartTime: '',\n        taskEndTime: '',\n        taskState: true,\n        taskIntroduction: '',\n        requirementDescriptionFileList: [],\n        executableFileList: [],\n        is_selected: false,\n        //todo:reportList数据获取\n        reportList: []\n      },\n      isAble: !this.taskState,\n      role: window.localStorage.getItem(\"role\"),\n      exeUrl: '',\n      exeName: '',\n      docUrl: '',\n      docName: ''\n    };\n  },\n\n  components: {\n    FolderChecked,\n    Edit,\n    StarFilled // ReportItem\n\n  },\n  methods: {\n    enroll() {\n      this.$router.push(\"/taskEnrollSucceed\");\n    },\n\n    showEnrollError() {\n      ElMessage.error('非常抱歉，报名已经结束，看看其他项目吧');\n    },\n\n    downloadExe() {\n      oss.ossGetDownloadUrl(this.task.executableFileList[0].fileURL.substr(49)).then(res => {\n        this.exeUrl = res.downloadURL;\n        this.exeName = this.task.executableFileList[0].fileName;\n        console.log(this.exeUrl);\n        console.log(this.exeName);\n      });\n    },\n\n    downloadDoc() {\n      oss.ossGetDownloadUrl(this.task.requirementDescriptionFileList[0].fileURL.substr(49)).then(res => {\n        this.docUrl = res.downloadURL;\n        this.docName = this.task.requirementDescriptionFileList[0].fileName;\n        console.log(this.docUrl);\n        console.log(this.docName);\n      });\n    },\n\n    goReport\n  },\n\n  mounted() {\n    if (this.role === '0') {\n      employerBrowserTaskDetail({\n        token: window.localStorage.getItem(\"token\"),\n        taskId: this.taskId\n      }).then(res => {\n        if (res.response.code === 0) {\n          console.log(res.response.msg);\n          this.task.workerNumTotal = res.workerNumTotal;\n          this.task.taskState = res.taskState;\n          this.task.workerNumLeft = res.workerNumLeft;\n          this.task.requirementDescriptionFileList = res.requirementDescriptionFileList;\n          this.task.executableFileList = res.executableFileList;\n          this.task.taskName = res.taskName;\n          this.task.taskIntroduction = res.taskIntroduction;\n          this.task.taskStartTime = res.beginTime;\n          this.task.taskEndTime = res.endTime;\n        }\n      });\n\n      if (this.role === '0' || this.role === '2') {\n        browserReports({\n          token: window.localStorage.getItem(\"token\"),\n          taskId: this.taskId\n        }).then(res => {\n          if (res.response.code === 0) {\n            this.task.reportList = res.reportList;\n          }\n        });\n      }\n    }\n  }\n\n};","map":{"version":3,"mappings":"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","names":["FolderChecked","ElMessage","Edit","StarFilled","employerBrowserTaskDetail","browserReports","oss","goReport","val","console","log","$router","push","path","params","taskId","reportId","name","data","$route","task","taskName","taskType","workerNumTotal","workerNumLeft","taskStartTime","taskEndTime","taskState","taskIntroduction","requirementDescriptionFileList","executableFileList","is_selected","reportList","isAble","role","window","localStorage","getItem","exeUrl","exeName","docUrl","docName","components","methods","enroll","showEnrollError","error","downloadExe","ossGetDownloadUrl","fileURL","substr","then","res","downloadURL","fileName","downloadDoc","mounted","token","response","code","msg","beginTime","endTime"],"sourceRoot":"","sources":["/home/lyk/Projects/Volatile/frontend-volatile/src/views/task/TaskInfoFromUser.vue"],"sourcesContent":["<template>\n  <el-divider></el-divider>\n  <el-breadcrumb separator=\"/\"  class=\"breadcrumb\">\n    <el-breadcrumb-item :to=\"{path: '/TaskSquare'}\">个人中心</el-breadcrumb-item>\n    <el-breadcrumb-item>任务详情</el-breadcrumb-item>\n  </el-breadcrumb>\n  <div class=\"container\">\n    <el-card class=\"box_card\">\n      <template #header>\n        <div class=\"card_header\">\n          <span style=\"font-size: larger\">{{task.taskName}}</span>\n          <div class=\"header_tags\">\n            <el-tag class=\"header_tag\" type=\"warning\">竞标中</el-tag>\n            <el-tag v-if=\"task.taskType === 0\" style=\"margin-left: 10px\">功能测试</el-tag>\n            <el-tag v-if=\"task.taskType === 1\" style=\"margin-left: 10px\" type=\"success\">性能测试</el-tag>\n          </div>\n        </div>\n      </template>\n      <div class=\"information\">\n        <div>发布日期 ： {{task.taskStartTime}}</div>\n        <div style=\"margin-top: 5px\">结束日期 ： {{task.taskEndTime}}</div>\n        <div style=\"margin-top: 5px\">参与人员 ： 剩余 <span style=\"font-weight: bold;color:#409efc \">{{task.workerNumLeft}}</span>  人  <el-divider direction=\"vertical\" ></el-divider>  总需  <span style=\"font-weight: bold;color:#409efc \">{{task.workerNumTotal}}</span> 人</div>\n      </div>\n      <div class=\"need_information\">\n        <div style=\"display: flex;flex-direction: row;margin-top:20px\">\n          <el-icon color=\"#409efc\" :size=\"30\">\n            <edit />\n          </el-icon>\n          <div style=\"font-size: large;margin-top: 2px;font-weight: bolder;margin-left: 5px\">需求描述</div>\n        </div>\n        <div style=\"margin-top: 10px\">任务简介 ： <span style=\"font-weight: bold\">{{task.taskIntroduction}}</span></div>\n      </div>\n      <div class=\"file_information\" >\n        <div style=\"display: flex;flex-direction: row;margin-top:20px\">\n          <el-icon color=\"#409efc\" :size=\"30\">\n            <folder-checked />\n          </el-icon>\n          <div style=\"font-size: large;margin-top: 2px;font-weight: bolder;margin-left: 5px\">附件下载</div>\n        </div>\n          <div>\n          <a :href=\"exeUrl\" download=\"待测应用可执行文件\">\n            <el-button type=\"text\" @click=\"downloadExe\">一、点击下载待测应用可执行文件</el-button>\n          </a>\n            <a :href=\"docUrl\" download=\"测试需求描述文件\">\n          <el-button type=\"text\" @click=\"downloadDoc\">二、点击下载测试需求描述文件</el-button>\n            </a>\n          </div>\n      </div>\n      <div ><el-button v-if=\"role === '1'\" type=\"danger\" style=\"margin-right:500px\">提交报告</el-button></div>\n      <el-divider ><el-icon><star-filled /></el-icon></el-divider>\n      <div class=\"report_container\" v-if=\"role === '0' || role === '2'\">\n        <el-row>\n          <el-col :span=\"15\"><span style=\"font-weight: bolder\">报告展示</span></el-col>\n          <el-col :span=\"5\">\n\n          </el-col>\n        </el-row>\n        <el-table :data=\"task.reportList\" height=\"250\" style=\"width:1500px;margin-top: 10px\" stripe border highlight-current-row @current-change=\"goReport\">\n          <el-table-column type=\"index\" width=\"50\"></el-table-column>\n          <el-table-column prop=\"reportId\" label=\"报告ID\" width=\"180\" />\n          <el-table-column prop=\"workerId\" label=\"测试工人ID\" width=\"180\" />\n        </el-table>\n      </div>\n    </el-card>\n  </div>\n</template>\n\n<script>\nimport {FolderChecked} from \"@element-plus/icons-vue\"\nimport {ElMessage} from \"element-plus\";\nimport {Edit} from \"@element-plus/icons-vue\"\nimport {StarFilled} from \"@element-plus/icons-vue\"\nimport {employerBrowserTaskDetail} from \"@/api/task\";\nimport {browserReports} from \"@/api/report\";\nimport oss from \"@/utils/oss\"\n\nconst goReport = (val) =>{\n  console.log(val)\n  this.$router.push({\n    path:\"/reportInfo\",\n    params:{\n      taskId:this.taskId,\n      reportId:val.reportId\n    }\n  })\n}\n\nexport default {\n  name: \"TaskInfoFromUser\",\n  data() {\n    return {\n      taskId: this.$route.params.taskId,\n      task: {\n        taskId: this.taskId,\n        taskName: '',\n        taskType: 0,\n        workerNumTotal: 0,\n        workerNumLeft: 0,\n        taskStartTime: '',\n        taskEndTime: '',\n        taskState: true,\n        taskIntroduction: '',\n        requirementDescriptionFileList:[],\n        executableFileList:[],\n        is_selected: false,\n        //todo:reportList数据获取\n        reportList:[\n        ]\n      },\n      isAble: !this.taskState,\n      role:window.localStorage.getItem(\"role\"),\n      exeUrl:'',\n      exeName:'',\n      docUrl:'',\n      docName:''\n    }\n  },\n  components: {\n    FolderChecked,\n    Edit,\n    StarFilled,\n    // ReportItem\n  },\n  methods: {\n    enroll(){\n      this.$router.push(\"/taskEnrollSucceed\")\n    },\n    showEnrollError(){\n      ElMessage.error('非常抱歉，报名已经结束，看看其他项目吧');\n    },\n    downloadExe(){\n      oss.ossGetDownloadUrl(this.task.executableFileList[0].fileURL.substr(49))\n      .then(res => {\n        this.exeUrl = res.downloadURL\n        this.exeName = this.task.executableFileList[0].fileName\n        console.log(this.exeUrl)\n        console.log(this.exeName)\n      })\n    },\n    downloadDoc(){\n      oss.ossGetDownloadUrl(this.task.requirementDescriptionFileList[0].fileURL.substr(49))\n          .then(res => {\n            this.docUrl = res.downloadURL\n            this.docName = this.task.requirementDescriptionFileList[0].fileName\n            console.log(this.docUrl)\n            console.log(this.docName)\n          })\n    },\n    goReport\n  },\n  mounted() {\n    if(this.role === '0')\n    {\n      employerBrowserTaskDetail({token:window.localStorage.getItem(\"token\"),taskId:this.taskId})\n      .then(res => {\n        if(res.response.code === 0)\n        {\n          console.log(res.response.msg)\n          this.task.workerNumTotal = res.workerNumTotal\n          this.task.taskState = res.taskState\n          this.task.workerNumLeft = res.workerNumLeft\n          this.task.requirementDescriptionFileList = res.requirementDescriptionFileList\n          this.task.executableFileList = res.executableFileList\n          this.task.taskName = res.taskName\n          this.task.taskIntroduction = res.taskIntroduction\n          this.task.taskStartTime = res.beginTime\n          this.task.taskEndTime = res.endTime\n        }\n      })\n\n      if(this.role === '0' || this.role === '2' )\n      {\n        browserReports({token:window.localStorage.getItem(\"token\"),taskId:this.taskId})\n        .then(res => {\n          if(res.response.code === 0)\n          {\n            this.task.reportList = res.reportList\n          }\n        })\n      }\n\n    }\n  }\n}\n</script>\n\n<style scoped>\n.breadcrumb{\n  margin-left: 20px;\n  font-family: 幼圆;\n  font-size: medium;\n  margin-top: -10px;\n}\n.box_card{\n  width: 90%;\n  margin-top: 10px;\n  margin-left: 5%;\n}\n.card_header{\n  margin-left: 5px;\n  display: flex;\n  flex-direction: column;\n}\n.header_tags{\n  display: flex;\n  flex-direction: row;\n  margin-top: 5px;\n}\n.information{\n  display: flex;\n  flex-direction: column;\n}\n.check_btn{\n  position: absolute;\n  right: 90px;\n  bottom: 65px;\n}\n</style>"]},"metadata":{},"sourceType":"module"}