{"ast":null,"code":"import { employeeTaskDetail } from \"@/api/square\";\nimport { Checked } from \"@element-plus/icons-vue\";\nimport { reactive } from \"vue\";\nimport { publishReport } from \"@/api/report\";\nimport oss from '@/utils/oss';\nconst report_form = reactive({\n  defectPictureList: [],\n  defectExplain: '',\n  defectReproductionStep: '',\n  testEquipmentInformation: ''\n});\nconst rules = reactive({\n  defectExplain: [{\n    required: true,\n    message: '请填写缺陷情况说明',\n    trigger: 'blur'\n  }, {\n    min: 5,\n    max: 100,\n    message: '缺陷情况说明不得少于5个字符，不得多于100个字符',\n    trigger: 'blur'\n  }],\n  defectReproductionStep: [{\n    required: true,\n    message: '请填写缺陷复现步骤',\n    trigger: 'blur'\n  }, {\n    min: 5,\n    max: 100,\n    message: '缺陷复现步骤不得少于5个字符，不得多于100个字符',\n    trigger: 'blur'\n  }],\n  testEquipmentInformation: [{\n    required: true,\n    message: '请填写测试设备信息',\n    trigger: 'blur'\n  }, {\n    min: 5,\n    max: 20,\n    message: '测试设备信息不得少于5个字符，不得多于20个字符',\n    trigger: 'blur'\n  }]\n});\nexport default {\n  name: \"ReportRelease\",\n\n  data() {\n    return {\n      report_form,\n      rules,\n      task: {},\n      taskId: this.$route.params.taskId,\n      fileList: []\n    };\n  },\n\n  mounted() {\n    employeeTaskDetail({\n      taskId: this.taskId,\n      token: window.localStorage.getItem(\"token\")\n    }).then(res => {\n      if (res.code === 1) {\n        console.log(\"获取任务数据成功\");\n        this.task = res.data.task;\n      } else {\n        console.log(res.msg);\n      }\n    });\n  },\n\n  components: {\n    Checked\n  },\n  methods: {\n    onSubmit() {\n      const token = window.localStorage.getItem(\"token\");\n      publishReport({\n        testReport: report_form,\n        token: token,\n        taskId: this.taskId\n      }).then(res => {\n        if (res.code === 1) {\n          console.log(res.msg);\n          console.log(res.data.testReport);\n        } else {\n          console.log(res.msg);\n        }\n      });\n    },\n\n    cancelSubmit() {\n      this.$router.back(-1);\n    },\n\n    async fnUploadRequest(option) {\n      await oss.ossUploadFile(option).then(res => {\n        const file = {\n          fileName: res.fileName,\n          fileUrl: res.fileUrl\n        };\n        report_form.defectPictureList.push(file);\n      });\n    },\n\n    handleUploadSuccess() {\n      console.log(report_form.defectPictureList); //todo:添加路由：报告提交成功\n    }\n\n  }\n};","map":{"version":3,"mappings":"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","names":["employeeTaskDetail","Checked","reactive","publishReport","oss","report_form","defectPictureList","defectExplain","defectReproductionStep","testEquipmentInformation","rules","required","message","trigger","min","max","name","data","task","taskId","$route","params","fileList","mounted","token","window","localStorage","getItem","then","res","code","console","log","msg","components","methods","onSubmit","testReport","cancelSubmit","$router","back","fnUploadRequest","option","ossUploadFile","file","fileName","fileUrl","push","handleUploadSuccess"],"sourceRoot":"","sources":["D:\\download\\大三\\大三下\\1 软工三\\project\\第一阶段\\frontend\\frontend-volatile\\src\\views\\report\\ReportRelease.vue"],"sourcesContent":["<template>\r\n  <div style=\"display: flex;justify-content: center;text-align: center\">\r\n  <el-card style=\"width: 80%\">\r\n    <template #header>\r\n      <span style=\"font-weight: bolder;font-size:x-large\">测试报告提交</span>\r\n    </template>\r\n    <div class=\"task_container\">\r\n      <el-descriptions>\r\n        <template #title>\r\n          <span>任务名称： {{task.taskName}}</span>\r\n        </template>\r\n        <el-descriptions-item label=\"任务简介\">{{task.taskIntroduction}}</el-descriptions-item>\r\n      </el-descriptions>\r\n    </div>\r\n    <div class=\"report_container\">\r\n      <div class=\"report_head_container\">\r\n        <el-icon color=\"#409efc\" :size=\"30\">\r\n          <checked />\r\n        </el-icon>\r\n        <div style=\"font-size: large;margin-top: 2px;font-weight: bolder;margin-left: 5px\">缺陷提交</div>\r\n      </div>\r\n      <el-form :model=\"report_form\" label-width=\"120px\" label-position=\"right\" style=\"width:80%\" :rules=\"rules\">\r\n        <el-form-item label=\"缺陷情况说明\" prop=\"defectExplain\">\r\n          <el-input v-model=\"report_form.defectExplain\" :rows=\"3\" type=\"textarea\" />\r\n        </el-form-item>\r\n        <el-form-item label=\"缺陷复现步骤\" prop=\"defectReproductionStep\">\r\n          <el-input v-model=\"report_form.defectReproductionStep\" :rows=\"2\" type=\"textarea\" />\r\n        </el-form-item>\r\n        <el-form-item label=\"测试设备信息\" prop=\"testEquipmentInformation\">\r\n          <el-input v-model=\"report_form.testEquipmentInformation\" placeholder=\"从应用启动到缺陷出现的操作步骤\"></el-input>\r\n        </el-form-item>\r\n        <el-form-item label=\"缺陷应用截图\" required>\r\n          <el-upload\r\n            action=\"\"\r\n            show-file-list\r\n            :auto-upload=\"true\"\r\n            :http-request=\"fnUploadRequest\"\r\n            :on-success=\"handleUploadSuccess\"\r\n            :file-list=\"fileList\"\r\n            list-type=\"picture\">\r\n            <el-button type=\"primary\">点击上传应用截图</el-button>\r\n            <template #tip>\r\n              <div style=\"color: #9A9A9A\">\r\n                请上传.jpg,.jpeg,.png类型的文件\r\n              </div>\r\n            </template>\r\n          </el-upload>\r\n        </el-form-item>\r\n        <el-form-item>\r\n          <el-button type=\"primary\" @click=\"onSubmit\">提交</el-button>\r\n          <el-button @click=\"cancelSubmit\">取消</el-button>\r\n        </el-form-item>\r\n      </el-form>\r\n    </div>\r\n  </el-card>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport {employeeTaskDetail} from \"@/api/square\";\r\nimport {Checked} from \"@element-plus/icons-vue\"\r\nimport {reactive} from \"vue\"\r\nimport {publishReport} from \"@/api/report\";\r\nimport oss from '@/utils/oss'\r\n\r\nconst report_form = reactive({\r\n  defectPictureList:[],\r\n  defectExplain:'',\r\n  defectReproductionStep:'',\r\n  testEquipmentInformation:''\r\n})\r\n\r\nconst rules = reactive({\r\n  defectExplain:[\r\n    {\r\n      required:true,\r\n      message:'请填写缺陷情况说明',\r\n      trigger:'blur'\r\n    },\r\n    {\r\n      min:5,\r\n      max:100,\r\n      message: '缺陷情况说明不得少于5个字符，不得多于100个字符',\r\n      trigger: 'blur'\r\n    }\r\n  ],\r\n  defectReproductionStep: [\r\n    {\r\n      required:true,\r\n      message:'请填写缺陷复现步骤',\r\n      trigger:'blur'\r\n    },\r\n    {\r\n      min:5,\r\n      max:100,\r\n      message: '缺陷复现步骤不得少于5个字符，不得多于100个字符',\r\n      trigger:'blur'\r\n    }\r\n  ],\r\n  testEquipmentInformation:[\r\n    {\r\n      required:true,\r\n      message:'请填写测试设备信息',\r\n      trigger:'blur'\r\n    },\r\n    {\r\n      min:5,\r\n      max:20,\r\n      message: '测试设备信息不得少于5个字符，不得多于20个字符',\r\n      trigger:'blur'\r\n    }\r\n  ],\r\n})\r\n\r\nexport default {\r\n  name: \"ReportRelease\",\r\n  data(){\r\n    return {\r\n      report_form,\r\n      rules,\r\n      task:{},\r\n      taskId:this.$route.params.taskId,\r\n      fileList:[],\r\n    }\r\n  },\r\n  mounted() {\r\n    employeeTaskDetail({taskId:this.taskId,token:window.localStorage.getItem(\"token\")})\r\n    .then(res => {\r\n      if(res.code === 1)\r\n      {\r\n        console.log(\"获取任务数据成功\")\r\n        this.task = res.data.task\r\n      }\r\n      else\r\n      {\r\n        console.log(res.msg)\r\n      }\r\n    })\r\n  },\r\n  components:{\r\n    Checked\r\n  },\r\n  methods:{\r\n    onSubmit() {\r\n      const token = window.localStorage.getItem(\"token\")\r\n      publishReport({testReport: report_form,token:token,taskId:this.taskId})\r\n      .then(res =>{\r\n        if(res.code === 1)\r\n        {\r\n          console.log(res.msg)\r\n          console.log(res.data.testReport)\r\n        }\r\n        else\r\n        {\r\n          console.log(res.msg)\r\n        }\r\n      })\r\n    },\r\n    cancelSubmit(){\r\n      this.$router.back(-1)\r\n    },\r\n    async fnUploadRequest(option){\r\n      await oss.ossUploadFile(option).then(res => {\r\n        const file = {\r\n          fileName:res.fileName,\r\n          fileUrl:res.fileUrl\r\n        }\r\n        report_form.defectPictureList.push(file)\r\n      })\r\n    },\r\n    handleUploadSuccess(){\r\n      console.log(report_form.defectPictureList)\r\n      //todo:添加路由：报告提交成功\r\n    }\r\n  }\r\n}\r\n</script>\r\n\r\n<style scoped>\r\n.report_head_container{\r\n  display: flex;\r\n  flex-direction: row;\r\n}\r\n</style>"]},"metadata":{},"sourceType":"module"}